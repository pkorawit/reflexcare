
    <ons-page id="smartCare">
        <ons-row style="margin-top:20px">
            <ons-col class="center">
                <div>
                    RECENTLY ADDED
                </div>
            </ons-col>
        </ons-row>
        <ons-row style="margin-top:20px;margin-bottom:20px">
            <ons-col>
                <ons-carousel swipeable>
                    <div class="ons-swiper-target ">
                        <ons-carousel-item>
                            <div class="center" id="recentlyTarget">
                                
                            </div>
                        </ons-carousel-item>
                        <ons-carousel-item>
                            <div class="center" id="recentlyTarget2">
                                
                            </div>
                        </ons-carousel-item>
                    </div>
                </ons-carousel>
            </ons-col>
        </ons-row>
        <ons-row style="margin-bottom:20px">
            <ons-col></ons-col>
            <ons-col width="92%" class="center">
                <ons-card class="center" style="padding-left:0px;padding-right:0px;padding-bottom:0px;padding-top:10px;border-radius:4px">
                    <div class="careText">
                        <div>ดูแลคนที่คุณห่ววงใยผ่าน Smart Care</div>
                        <div>โดยที่คุณสามาถดูผลสุขภาพของคนที่คุณรักผ่าน Applications นี้</div>
                        <div>รายงานผลสุขภาพประจำวันและแจ้งเตือนเมื่อผลวิเคราะห์มีความเสี่ยงที่จะไม่สบาย / ควรพบแพทย์</div>
                    </div>
                    <div style="margin-bottom:10px">
                        <div style="color:#f53737">
                            ฟรี!!! 1 User ถึง กันยายน 61
                        </div>
                        <div style="color:#f53737">
                            ค่าบริการ 199 บาท | 1 User | เดือน
                        </div>
                    </div>
                    <div style="background-color: #f16f5dee;    border-bottom-left-radius: 4px;;    border-bottom-right-radius: 4px;color: aliceblue;">สมัครใช้บริการ</div>
                </ons-card>
            </ons-col>
            <ons-col></ons-col>
        </ons-row>
        <ons-row style="margin-bottom:20px">
            <ons-col class="center">
                YOUR FAMILY
            </ons-col>
        </ons-row>

        <ons-row id="family" class="center">
            
        </ons-row>
        <ons-row class="center">
                <div class="marginAuto" >
                        <img class="smartProfile" src="https://cdn1.iconfinder.com/data/icons/rounded-flat-country-flag-collection-1/2000/ch-01.png" alt="">
                </div>
        </ons-row>
        <script>
                document.addEventListener('init', function (event) {
                        var page = event.target;
                        var currentUser = page.data.currentUser;
                        if (page.id == "smartCare") {
                            console.log(currentUser.profile.userid);
                            SmartReflex.getUser(currentUser.profile.userid).then(function (messages, doc) {
                                doc.connections.forEach((connections) => {
                                    SmartReflex.getScore(connections.userid).then(function (messages, score) {
                                        SmartReflex.getUser(connections.userid).then(function (message, data) {
                                            console.log(score);
                                            console.log(data);
                                            var connectionData = {
                                                alert: score.today.alert,
                                                hr: score.today.HR,
                                                step: score.today.steps,
                                                cal: score.today.distance,
                                                name: data.profile.firstname,
                                                img: data.profile.photo,
                                                meta: score.today.scores.metabolism,
                                                heart: score.today.scores.heart,
                                                motion: score.today.scores.motion,
                                                id: data.profile.firstname,
                                                userid: data.profile.userid
                                            }
                                            var template = $('#familyTemplate').html();
                                            var recentlyTemplate = $('#recentlyTemplate').html();
                                            Mustache.parse(template);
                                            Mustache.parse(recentlyTemplate);
                                            var rendered = Mustache.render(template, connectionData);
                                            var recentlyRendered = Mustache.render(recentlyTemplate, connectionData);
                                            $('#family').append(rendered);
                                            $('#recentlyTarget').append(recentlyRendered);
                                        })
                                    })
                                })
                            })
                        }
                    })
        </script>
    </ons-page>
